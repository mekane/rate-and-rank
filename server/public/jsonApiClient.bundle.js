var DataGrid=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=27)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),o=n(12);function i(e,t,n){var i,a,l,c={};if(void 0!==n?(c=t,o.array(n)?i=n:o.primitive(n)?a=n:n&&n.sel&&(i=[n])):void 0!==t&&(o.array(t)?i=t:o.primitive(t)?a=t:t&&t.sel?i=[t]:c=t),void 0!==i)for(l=0;l<i.length;++l)o.primitive(i[l])&&(i[l]=r.vnode(void 0,void 0,void 0,i[l],void 0));return"s"!==e[0]||"v"!==e[1]||"g"!==e[2]||3!==e.length&&"."!==e[3]&&"#"!==e[3]||function e(t,n,r){if(t.ns="http://www.w3.org/2000/svg","foreignObject"!==r&&void 0!==n)for(var o=0;o<n.length;++o){var i=n[o].data;void 0!==i&&e(i,n[o].children,n[o].sel)}}(c,i,e),r.vnode(e,c,i,a,void 0)}t.h=i,t.default=i},,function(e,t,n){"use strict";n.d(t,"a",(function(){return _}));const r=n(10);function o(e,t){return`${r.toCssClassName(e)}${t}`}function i(e){return{"grid-template-columns":`repeat(${e+1}, 1fr)`}}function a(e){"Tab"===e.key&&e.preventDefault()}function l(e,t){let n;n=t?function(e){let t;if(e.classList.contains("grid-cell")){if(t=e.previousSibling,console.log("previous cell",t),t)return t;const n=e.parentElement.previousSibling;if(n){const e=n.querySelector(".grid-cell:last-child");if(e)return e}}}(e):function(e){let t;if(e.classList.contains("grid-cell")){if(t=e.nextSibling,console.log("next cell",t),t)return t;const n=e.parentElement.nextSibling;if(n){const e=n.querySelector(".grid-cell");if(e)return e}}}(e),n&&n.click()}const c=n(0).default,u={name:"__rank_column",type:"number",isRankColumn:!0};function d(e,t){return function(e){!function(e,t){const n=e.textContent,r=document.createElement("input");r.type="number",r.min=1,r.value=n;const o={action:"moveRow",rowIndex:t};function i(){o.newIndex=r.value-1,r.blur(),window.action(o)}e.innerHTML="",e.append(r),r.select(),r.addEventListener("blur",(function(){r.remove(),e.innerHTML=n})),r.addEventListener("keydown",a),r.addEventListener("keyup",t=>{switch(t.key){case"Enter":i();break;case"Esc":case"Escape":r.blur();break;case"Tab":i(),l(e,t.shiftKey);break;default:return}})}(e.target,t)}}const s=n(0).default;function f(e,t,n){const r={on:{click:k(e,n)}},i=o(e.name,n);r.class={[i]:!0};const a="image"===e.type?function(t){const r=[];if((o=t)&&o.length){const e=s("img",{attrs:{src:t}});r.push(e)}else{const t={on:{click:v,dragenter:p,dragover:p,dragleave:m,drop:[g,n,e.name]}},o=s("div.image-drop-target",t,"Drop Image or Click Here");r.push(o)}var o;const i={attrs:{type:"file",accept:"image/*"},style:{display:"none"},on:{change:[y,n,e.name]}},a=s("input",i);return r.push(a),r}(t):t;return s("div.grid-cell",r,a)}function v(e){e.target.parentElement.querySelector('input[type="file"]').click()}function p(e){e.dataTransfer.types.includes("Files")&&(e.preventDefault(),e.currentTarget.classList.add("drophighlight"))}function m(e){e.currentTarget.classList.remove("drophighlight")}function g(e,t,n){n.preventDefault(),m(n),h(n.dataTransfer).then(n=>x(e,t,n))}function h(e){const t=[...e.types],n=t.includes("Files"),r=t.includes("text/uri-list"),o=t.includes("text/plain");if(n){return b([...e.files][0])}if(r){return w(e.getData("text/uri-list"))}if(o){return w(e.getData("text/plain"))}console.log("No data found in dropped item")}function y(e,t,n){return b(n.target.files[0]).then(n=>x(e,t,n))}function b(e){return new Promise(t=>{let n=new FileReader;n.readAsDataURL(e),n.addEventListener("load",e=>t(n.result))})}function w(e){return new Promise(t=>{const n=new Image;n.crossOrigin="anonymous",n.onload=function(){const e=document.createElement("canvas");e.width=this.naturalWidth,e.height=this.naturalHeight,e.getContext("2d").drawImage(this,0,0),t(e.toDataURL("image/png"))},n.src=e})}function x(e,t,n){window.action({action:"setField",rowIndex:e,columnName:t,value:n})}function k(e,t){if("image"===e.type)return void console.log("cell clicked");let n="text";return"number"===e.type&&(n="number"),function(r){const o=r.target,i=o.textContent,c=document.createElement("input");c.type=n,c.value=i;const u={action:"setField",rowIndex:t,columnName:e.name};function d(){u.value=c.value,window.action(u)}o.innerHTML="",o.append(c),c.select(),c.addEventListener("blur",(function(){c.remove(),o.innerHTML=i})),c.addEventListener("keydown",a),c.addEventListener("keyup",e=>{switch(e.key){case"Enter":d();break;case"Esc":case"Escape":c.blur();break;case"Tab":d(),l(o,e.shiftKey);break;default:return}})}}const E=n(0).default;function T(e,t,n){const r=function(e){const t={on:{click:d(u,e)}},n=o("__rank-column",e);return t.class={[n]:!0},c("div.grid-cell",t,e+1)}(t),a=n.map(n=>f(n,e[n.name],t)),l={attrs:{draggable:"true"},on:{dragstart:function(e){const n=e.dataTransfer,r=JSON.stringify({action:"moveRow",rowIndex:t});e.currentTarget.classList.add("dragging"),n.setData("text/actionjson",r),n.effectAllowed="move"},dragenter:s,dragover:s,dragleave:function(e){e.currentTarget.classList.remove("drophighlight")},drop:function(e){e.preventDefault(),e.currentTarget.classList.remove("drophighlight");const n=function(e){const t=e.dataTransfer.getData("text/actionjson");if(""===t)return{};let n={};try{n=JSON.parse(t)}catch(e){console.log("Error processing row drop "+e)}return n}(e);"moveRow"===n.action&&(n.newIndex=t,window.action(n))}},style:i(n.length)};return E("div.row",l,[r].concat(a));function s(e){var t;"move"===(t=e.dataTransfer).effectAllowed&&t.types.includes("text/actionjson")&&(e.preventDefault(),e.currentTarget.classList.add("drophighlight"))}}const L=n(0).default;function C(e){const t=e.config.columns,n={on:{dragenter:S,dragover:S,drop:S}},r=L("div.title",e.config.name),o=function(e){const t=i(e.length),n=[u({name:"Rank",type:"number"})].concat(e.map(u));return L("div.column-header-row",{style:t},n)}(t),a=e.rows.map((e,n)=>T(e,n,t)),l=L("div.add-row",{on:{click:e=>window.action({action:"addRow"})}},"+ Add Row"),c=[r,o].concat(a).concat(l);return L("div.grid",n,c);function u(e){return L("div.grid-column-header",e.name)}}function S(e){e.preventDefault(),e.stopPropagation()}const M=n(13).init([n(5).default,n(6).default,n(7).default,n(8).default,n(9).default]);function _(e,t){let n=e;window.action=t.send,t.subscribe((function(e){console.log("Got new state from action module",e);const t=C(e);n=M(n,t)})),function(e){return new Promise((t,n)=>{"complete"===e.readyState?t("Document already ready"):e.addEventListener("readystatechange",n=>{"complete"===e.readyState&&t("Document became ready")})})}(document).then(N).then(t.send({action:"refresh"}))}function N(){document.querySelector("body").addEventListener("keyup",e=>{let t=e.key;switch(e.ctrlKey&&(t="ctrl+"+t),t){case"ctrl+z":action({action:"undo"});break;case"ctrl+Z":action({action:"redo"})}})}},,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e,t){var n,r=t.elm,o=e.data.attrs,i=t.data.attrs;if((o||i)&&o!==i){for(n in o=o||{},i=i||{}){var a=i[n];o[n]!==a&&(!0===a?r.setAttribute(n,""):!1===a?r.removeAttribute(n):120!==n.charCodeAt(0)?r.setAttribute(n,a):58===n.charCodeAt(3)?r.setAttributeNS("http://www.w3.org/XML/1998/namespace",n,a):58===n.charCodeAt(5)?r.setAttributeNS("http://www.w3.org/1999/xlink",n,a):r.setAttribute(n,a))}for(n in o)n in i||r.removeAttribute(n)}}t.attributesModule={create:r,update:r},t.default=t.attributesModule},function(e,t,n){"use strict";function r(e,t){var n,r,o=t.elm,i=e.data.class,a=t.data.class;if((i||a)&&i!==a){for(r in a=a||{},i=i||{})a[r]||o.classList.remove(r);for(r in a)(n=a[r])!==i[r]&&o.classList[n?"add":"remove"](r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.classModule={create:r,update:r},t.default=t.classModule},function(e,t,n){"use strict";function r(e,t){var n,r,o=t.elm,i=e.data.props,a=t.data.props;if((i||a)&&i!==a){for(n in a=a||{},i=i||{})a[n]||delete o[n];for(n in a)r=a[n],i[n]===r||"value"===n&&o[n]===r||(o[n]=r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.propsModule={create:r,update:r},t.default=t.propsModule},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="undefined"!=typeof window&&window.requestAnimationFrame.bind(window)||setTimeout,o=!1;function i(e,t,n){var o;o=function(){e[t]=n},r((function(){r(o)}))}function a(e,t){var n,r,o=t.elm,a=e.data.style,l=t.data.style;if((a||l)&&a!==l){l=l||{};var c="delayed"in(a=a||{});for(r in a)l[r]||("-"===r[0]&&"-"===r[1]?o.style.removeProperty(r):o.style[r]="");for(r in l)if(n=l[r],"delayed"===r&&l.delayed)for(var u in l.delayed)n=l.delayed[u],c&&n===a.delayed[u]||i(o.style,u,n);else"remove"!==r&&n!==a[r]&&("-"===r[0]&&"-"===r[1]?o.style.setProperty(r,n):o.style[r]=n)}}t.styleModule={pre:function(){o=!1},create:a,update:a,destroy:function(e){var t,n,r=e.elm,o=e.data.style;if(o&&(t=o.destroy))for(n in t)r.style[n]=t[n]},remove:function(e,t){var n=e.data.style;if(n&&n.remove){o||(e.elm.offsetLeft,o=!0);var r,i=e.elm,a=0,l=n.remove,c=0,u=[];for(r in l)u.push(r),i.style[r]=l[r];for(var d=getComputedStyle(i)["transition-property"].split(", ");a<d.length;++a)-1!==u.indexOf(d[a])&&c++;i.addEventListener("transitionend",(function(e){e.target===i&&--c,0===c&&t()}))}else t()}},t.default=t.styleModule},function(e,t,n){"use strict";function r(e,t){var n=e.type,r=t.data.on;r&&r[n]&&function e(t,n,r){if("function"==typeof t)t.call(n,r,n);else if("object"==typeof t)if("function"==typeof t[0])if(2===t.length)t[0].call(n,t[1],r,n);else{var o=t.slice(1);o.push(r),o.push(n),t[0].apply(n,o)}else for(var i=0;i<t.length;i++)e(t[i],n,r)}(r[n],t,e)}function o(e,t){var n,o=e.data.on,i=e.listener,a=e.elm,l=t&&t.data.on,c=t&&t.elm;if(o!==l){if(o&&i)if(l)for(n in o)l[n]||a.removeEventListener(n,i,!1);else for(n in o)a.removeEventListener(n,i,!1);if(l){var u=t.listener=e.listener||function e(t){r(t,e.vnode)};if(u.vnode=t,o)for(n in l)o[n]||c.addEventListener(n,u,!1);else for(n in l)c.addEventListener(n,u,!1)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.eventListenersModule={create:o,update:o,destroy:o},t.default=t.eventListenersModule},function(e,t){e.exports={toCssClassName:function(e){return"c"+e.replace(/\s|-/g,"_").replace(/[\W]/g,"")}}},function(e,t,n){"use strict";function r(e,t,n,r,o){return{sel:e,data:t,children:n,text:r,elm:o,key:void 0===t?void 0:t.key}}Object.defineProperty(t,"__esModule",{value:!0}),t.vnode=r,t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.array=Array.isArray,t.primitive=function(e){return"string"==typeof e||"number"==typeof e}},function(e,t,n){"use strict";function r(e,t,n,r,o){return{sel:e,data:t,children:n,text:r,elm:o,key:void 0===t?void 0:t.key}}n.r(t),n.d(t,"h",(function(){return c})),n.d(t,"thunk",(function(){return f})),n.d(t,"init",(function(){return b}));var o=r,i=Array.isArray;function a(e){return"string"==typeof e||"number"==typeof e}var l={createElement:function(e){return document.createElement(e)},createElementNS:function(e,t){return document.createElementNS(e,t)},createTextNode:function(e){return document.createTextNode(e)},createComment:function(e){return document.createComment(e)},insertBefore:function(e,t,n){e.insertBefore(t,n)},removeChild:function(e,t){e.removeChild(t)},appendChild:function(e,t){e.appendChild(t)},parentNode:function(e){return e.parentNode},nextSibling:function(e){return e.nextSibling},tagName:function(e){return e.tagName},setTextContent:function(e,t){e.textContent=t},getTextContent:function(e){return e.textContent},isElement:function(e){return 1===e.nodeType},isText:function(e){return 3===e.nodeType},isComment:function(e){return 8===e.nodeType}};function c(e,t,n){var o,l,c,u={};if(void 0!==n?(u=t,i(n)?o=n:a(n)?l=n:n&&n.sel&&(o=[n])):void 0!==t&&(i(t)?o=t:a(t)?l=t:t&&t.sel?o=[t]:u=t),void 0!==o)for(c=0;c<o.length;++c)a(o[c])&&(o[c]=r(void 0,void 0,void 0,o[c],void 0));return"s"!==e[0]||"v"!==e[1]||"g"!==e[2]||3!==e.length&&"."!==e[3]&&"#"!==e[3]||function e(t,n,r){if(t.ns="http://www.w3.org/2000/svg","foreignObject"!==r&&void 0!==n)for(var o=0;o<n.length;++o){var i=n[o].data;void 0!==i&&e(i,n[o].children,n[o].sel)}}(u,o,e),r(e,u,o,l,void 0)}function u(e,t){t.elm=e.elm,e.data.fn=t.data.fn,e.data.args=t.data.args,t.data=e.data,t.children=e.children,t.text=e.text,t.elm=e.elm}function d(e){var t=e.data;u(t.fn.apply(void 0,t.args),e)}function s(e,t){var n,r=e.data,o=t.data,i=r.args,a=o.args;if(r.fn===o.fn&&i.length===a.length){for(n=0;n<a.length;++n)if(i[n]!==a[n])return void u(o.fn.apply(void 0,a),t);u(e,t)}else u(o.fn.apply(void 0,a),t)}var f=function(e,t,n,r){return void 0===r&&(r=n,n=t,t=void 0),c(e,{key:t,hook:{init:d,prepatch:s},fn:n,args:r})};function v(e){return void 0===e}function p(e){return void 0!==e}var m=o("",{},[],void 0,void 0);function g(e,t){return e.key===t.key&&e.sel===t.sel}function h(e,t,n){var r,o,i,a={};for(r=t;r<=n;++r)null!=(i=e[r])&&void 0!==(o=i.key)&&(a[o]=r);return a}var y=["create","update","remove","destroy","pre","post"];function b(e,t){var n,r,c={},u=void 0!==t?t:l;for(n=0;n<y.length;++n)for(c[y[n]]=[],r=0;r<e.length;++r){var d=e[r][y[n]];void 0!==d&&c[y[n]].push(d)}function s(e,t){return function(){if(0==--t){var n=u.parentNode(e);u.removeChild(n,e)}}}function f(e,t){var n,r=e.data;void 0!==r&&p(n=r.hook)&&p(n=n.init)&&(n(e),r=e.data);var o=e.children,l=e.sel;if("!"===l)v(e.text)&&(e.text=""),e.elm=u.createComment(e.text);else if(void 0!==l){var d=l.indexOf("#"),s=l.indexOf(".",d),g=d>0?d:l.length,h=s>0?s:l.length,y=-1!==d||-1!==s?l.slice(0,Math.min(g,h)):l,b=e.elm=p(r)&&p(n=r.ns)?u.createElementNS(n,y):u.createElement(y);for(g<h&&b.setAttribute("id",l.slice(g+1,h)),s>0&&b.setAttribute("class",l.slice(h+1).replace(/\./g," ")),n=0;n<c.create.length;++n)c.create[n](m,e);if(i(o))for(n=0;n<o.length;++n){var w=o[n];null!=w&&u.appendChild(b,f(w,t))}else a(e.text)&&u.appendChild(b,u.createTextNode(e.text));p(n=e.data.hook)&&(n.create&&n.create(m,e),n.insert&&t.push(e))}else e.elm=u.createTextNode(e.text);return e.elm}function b(e,t,n,r,o,i){for(;r<=o;++r){var a=n[r];null!=a&&u.insertBefore(e,f(a,i),t)}}function w(e){var t,n,r=e.data;if(void 0!==r){for(p(t=r.hook)&&p(t=t.destroy)&&t(e),t=0;t<c.destroy.length;++t)c.destroy[t](e);if(void 0!==e.children)for(n=0;n<e.children.length;++n)null!=(t=e.children[n])&&"string"!=typeof t&&w(t)}}function x(e,t,n,r){for(;n<=r;++n){var o=void 0,i=void 0,a=void 0,l=t[n];if(null!=l)if(p(l.sel)){for(w(l),i=c.remove.length+1,a=s(l.elm,i),o=0;o<c.remove.length;++o)c.remove[o](l,a);p(o=l.data)&&p(o=o.hook)&&p(o=o.remove)?o(l,a):a()}else u.removeChild(e,l.elm)}}function k(e,t,n){var r,o;p(r=t.data)&&p(o=r.hook)&&p(r=o.prepatch)&&r(e,t);var i=t.elm=e.elm,a=e.children,l=t.children;if(e!==t){if(void 0!==t.data){for(r=0;r<c.update.length;++r)c.update[r](e,t);p(r=t.data.hook)&&p(r=r.update)&&r(e,t)}v(t.text)?p(a)&&p(l)?a!==l&&function(e,t,n,r){for(var o,i,a,l=0,c=0,d=t.length-1,s=t[0],p=t[d],m=n.length-1,y=n[0],w=n[m];l<=d&&c<=m;)null==s?s=t[++l]:null==p?p=t[--d]:null==y?y=n[++c]:null==w?w=n[--m]:g(s,y)?(k(s,y,r),s=t[++l],y=n[++c]):g(p,w)?(k(p,w,r),p=t[--d],w=n[--m]):g(s,w)?(k(s,w,r),u.insertBefore(e,s.elm,u.nextSibling(p.elm)),s=t[++l],w=n[--m]):g(p,y)?(k(p,y,r),u.insertBefore(e,p.elm,s.elm),p=t[--d],y=n[++c]):(void 0===o&&(o=h(t,l,d)),v(i=o[y.key])?(u.insertBefore(e,f(y,r),s.elm),y=n[++c]):((a=t[i]).sel!==y.sel?u.insertBefore(e,f(y,r),s.elm):(k(a,y,r),t[i]=void 0,u.insertBefore(e,a.elm,s.elm)),y=n[++c]));(l<=d||c<=m)&&(l>d?b(e,null==n[m+1]?null:n[m+1].elm,n,c,m,r):x(e,t,l,d))}(i,a,l,n):p(l)?(p(e.text)&&u.setTextContent(i,""),b(i,null,l,0,l.length-1,n)):p(a)?x(i,a,0,a.length-1):p(e.text)&&u.setTextContent(i,""):e.text!==t.text&&(p(a)&&x(i,a,0,a.length-1),u.setTextContent(i,t.text)),p(o)&&p(r=o.postpatch)&&r(e,t)}}return function(e,t){var n,r,i,a=[];for(n=0;n<c.pre.length;++n)c.pre[n]();for(function(e){return void 0!==e.sel}(e)||(e=function(e){var t=e.id?"#"+e.id:"",n=e.className?"."+e.className.split(" ").join("."):"";return o(u.tagName(e).toLowerCase()+t+n,{},[],void 0,e)}(e)),g(e,t)?k(e,t,a):(r=e.elm,i=u.parentNode(r),f(t,a),null!==i&&(u.insertBefore(i,t.elm,u.nextSibling(r)),x(i,[e],0,0))),n=0;n<a.length;++n)a[n].data.hook.insert(a[n]);for(n=0;n<c.post.length;++n)c.post[n]();return t}}},,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){const t=new Set;return{send:function(n){const r=JSON.stringify({action:n});return console.log("send "+r),fetch(e,{method:"PUT",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json"},body:r}).then(e=>e.json()).then(e=>{var n;return n=e,t.forEach(e=>{"function"==typeof e?e(n):"function"==typeof e.update&&e.update(n)}),e}).catch(e=>{console.log("Network Error",e)})},subscribe:function(e){t.add(e)}}}n.r(t),n.d(t,"initGrid",(function(){return i}));var o=n(2);function i(e,t){const n=document.querySelector(e),i=r(t);Object(o.a)(n,i),console.log("DataGrid initialized on element "+e,n)}}]);